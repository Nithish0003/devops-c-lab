version: 0.2

phases:
  pre_build:
    commands:
      - sudo wget https://dev.mysql.com/get/mysql80-community-release-el9-4.noarch.rpm
      - sudo yum localinstall mysql80-community-release-el9-4.noarch.rpm -y
      - sudo yum install mysql-server -y
      - sudo dnf install docker -y
      # - sudo systemctl start docker.service
  build:
    commands:
        - npm install
        - npm audit fix --force
        - echo "Building docker image"
        # - echo "Nits$001@20003" | docker login -u "nithishns" --password-stdin "docker.io
        - cat ./my_password.txt | docker login --username nithishns --password-stdin
        - docker build . -t docker.io/nithishns/test:v1   
        - docker push docker.io/nithishns/test:v1 
  post_build:
    commands:
        # - npm start
        - docker run -d -p 3002:3000 --name node1 docker.io/nithishns/test:v1 

      #  - npm clean
      #  - npm compile
      #  - npm test
      #  - npm package
